"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DataItemProxy = void 0;
const mapproxy_1 = require("../document/mapproxy");
/**
 * One data item in a collection, consisting of key-value pairs
 */
class DataItemProxy {
    /**
     * @param primaryKey The current primary key of the data item. This may change if the fields on the data item change, rendering this proxy inoperable.
     * @param collection The collection that contains this data item.
     * @param client
     */
    constructor(primaryKey, collection, client) {
        this.primaryKey = primaryKey;
        this.collection = collection;
        this.client = client;
        /**
         * The fields on this data item, organized by their name.
         */
        this.fields = new mapproxy_1.MapProxy(() => this.client.sendCommand("lcf" /* CommandName.ListCollectionFields */, { 'id': this.collection.id }), (name) => this.client.sendCommand("gdif" /* CommandName.GetDataItemField */, {
            'c': this.collection.id,
            'pk': this.primaryKey,
            'f': name,
        }));
    }
    /**
     * @returns True if a data item exists in this collection at this primary key
     */
    exists() {
        return this.client.sendCommand("die" /* CommandName.DataItemExists */, { 'c': this.collection.id, 'pk': this.primaryKey });
    }
}
exports.DataItemProxy = DataItemProxy;
